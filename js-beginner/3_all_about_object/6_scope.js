/**
 * =====================================================================
 * Scope(ìŠ¤ì½”í”„) - ë©´ì ‘ ë¹ˆì¶œ "ì´í•´ ì¤‘ì‹¬" ìµœì¢… í…œí”Œë¦¿ (2026)
 * =====================================================================
 * â­ = ì‹¤ë¬´ì—ì„œ ìì£¼ ì”€ / ğŸ”¥ = ë©´ì ‘ í•µì‹¬ / ğŸ›¡ï¸ = ì‹¤ìˆ˜ ë°©ì§€(Safety)
 *
 * [ë§¨ ìœ„ ê²°ë¡ : "ì§„ì§œ ì¤‘ìš”" vs "ê°œë…ë§Œ" âœ…]
 * âœ… ì§„ì§œ ì¤‘ìš”(ë©´ì ‘/ì‹¤ë¬´ ë‘˜ ë‹¤) â­ğŸ”¥
 * - JSëŠ” "ë ‰ì‹œì»¬ ìŠ¤ì½”í”„"ë‹¤: ì„ ì–¸ëœ ìœ„ì¹˜ê°€ ìƒìœ„ ìŠ¤ì½”í”„ë¥¼ ê²°ì •í•œë‹¤.
 * - ìŠ¤ì½”í”„ ì²´ì¸: ì‹ë³„ìë¥¼ ì°¾ì„ ë•Œ (í˜„ì¬) â†’ (ë°”ê¹¥) â†’ ... â†’ (ì „ì—­)
 * - var vs let/const: varëŠ” í•¨ìˆ˜ ìŠ¤ì½”í”„, let/constëŠ” ë¸”ë¡ ìŠ¤ì½”í”„ + TDZ
 * - í´ë¡œì €: ë°”ê¹¥ ìŠ¤ì½”í”„ ë³€ìˆ˜ë¥¼ "ê¸°ì–µ"í•˜ëŠ” í•¨ìˆ˜(ì‹¤ë¬´ì—ì„œë„ ë§¤ìš° ìì£¼ ë“±ì¥)
 *
 * â˜‘ï¸ ê°œë…ë§Œ ì´í•´í•˜ë©´ ì¶©ë¶„
 * - ë™ì  ìŠ¤ì½”í”„(dynamic scope): JSëŠ” ì•„ë‹ˆë‹¤(ì„¤ëª…ìš© ë¹„êµ)
 * - ë‚´ë¶€ ìš©ì–´(í™˜ê²½ ë ˆì½”ë“œ ë“±): ì›ë¦¬ë§Œ ì•Œë©´ OK
 *
 * [í•µì‹¬ì •ë¦¬(ë¨¼ì € ì½ê¸°) ğŸ”¥]
 * 1) ìŠ¤ì½”í”„ = "ë³€ìˆ˜ë¥¼ ì–´ë””ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œê°€"ì˜ ê·œì¹™
 * 2) JSëŠ” ë ‰ì‹œì»¬ ìŠ¤ì½”í”„: í•¨ìˆ˜ê°€ "ì–´ë””ì„œ ì‹¤í–‰"ëëŠ”ì§€ê°€ ì•„ë‹ˆë¼ "ì–´ë””ì„œ ì„ ì–¸"ëëŠ”ì§€ê°€ ì¤‘ìš”
 * 3) let/constëŠ” TDZ ë•Œë¬¸ì— ì„ ì–¸ ì „ì— ì ‘ê·¼í•˜ë©´ ReferenceError
 * 4) í´ë¡œì €ëŠ” ìŠ¤ì½”í”„ì˜ ê²°ê³¼ë¬¼: í•¨ìˆ˜ê°€ ë°”ê¹¥ ë³€ìˆ˜ë¥¼ ê³„ì† ì°¸ì¡°í•  ìˆ˜ ìˆìŒ
 */

console.clear?.();

// ---------------------------------------------------------------------
// [Utility] ì¶œë ¥ í¬ë§·íŒ…
// ---------------------------------------------------------------------
const line = (n = 86) => '='.repeat(n);
const section = (title) => {
   console.log(`\n${line()}`);
   console.log(`â–¶ ${title}`);
   console.log(line());
};

// =====================================================================
// 1) [ì´ˆê¸‰] ìŠ¤ì½”í”„ ì²´ì¸: "ì°¾ëŠ” ìˆœì„œ"ê°€ ì „ë¶€ë‹¤
// =====================================================================
{
   section('1. [ì´ˆê¸‰] ìŠ¤ì½”í”„ ì²´ì¸: í˜„ì¬ â†’ ë°”ê¹¥ â†’ ì „ì—­');

   const globalValue = 20;

   function outer() {
      const outerValue = 40;

      function inner() {
         const innerValue = 99;

         // ì™œ ì´ ìˆœì„œë¡œ ì°¾ë‚˜?
         // - ì—”ì§„ì€ í˜„ì¬ ìŠ¤ì½”í”„ë¶€í„° ì‹ë³„ìë¥¼ ì°¾ê³ , ì—†ìœ¼ë©´ ë°”ê¹¥ìœ¼ë¡œ ì˜¬ë¼ê°(ìŠ¤ì½”í”„ ì²´ì¸)
         console.log('innerValue:', innerValue);
         console.log('outerValue:', outerValue);
         console.log('globalValue:', globalValue);
      }

      inner();
      console.log('outerValue(outer):', outerValue);
   }

   outer();
   console.log('globalValue(global):', globalValue);

   // console.log(innerValue); // âŒ innerValueëŠ” inner ìŠ¤ì½”í”„ ë°–ì´ë¼ ì ‘ê·¼ ë¶ˆê°€
}

// =====================================================================
// 2) [ì¤‘ê¸‰] ğŸ”¥ ë ‰ì‹œì»¬ ìŠ¤ì½”í”„(ë©´ì ‘ ë‹¨ê³¨): "ì„ ì–¸ ìœ„ì¹˜"ê°€ ìƒìœ„ ìŠ¤ì½”í”„ë¥¼ ê²°ì •
// =====================================================================
{
   section('2. [ì¤‘ê¸‰] ë ‰ì‹œì»¬ ìŠ¤ì½”í”„(ğŸ”¥ ë©´ì ‘ ë‹¨ê³¨)');

   /**
    * í•µì‹¬ ì§ˆë¬¸(ë©´ì ‘): "ì™œ ì•„ë˜ëŠ” 100ì´ ì•„ë‹ˆë¼ 3ì´ ì°íˆë‚˜ìš”?"
    * ì •ë‹µ: JSëŠ” ë ‰ì‹œì»¬ ìŠ¤ì½”í”„ë¼ì„œ functionTwoì˜ ìƒìœ„ ìŠ¤ì½”í”„ëŠ” "ì„ ì–¸ëœ ìœ„ì¹˜" ê¸°ì¤€ìœ¼ë¡œ ê²°ì •ë¨.
    */

   const numberThree = 3;

   function functionTwo() {
      console.log('functionTwo sees:', numberThree);
   }

   function functionOne() {
      const numberThree = 100;
      functionTwo();
   }

   functionOne();

   // ë§Œì•½ JSê°€ ë™ì  ìŠ¤ì½”í”„ë¼ë©´? (ì‹¤í–‰ ìœ„ì¹˜ ê¸°ì¤€)
   // functionTwoê°€ functionOne ì•ˆì—ì„œ ì‹¤í–‰ë˜ë‹ˆê¹Œ 100ì´ ë‚˜ì™”ê² ì§€ë§Œ,
   // JSëŠ” ê·¸ëŸ° ì–¸ì–´ê°€ ì•„ë‹ˆë‹¤. ğŸ”¥
}

// =====================================================================
// 3) [ê³ ê¸‰] ğŸ”¥ var vs let/const + Shadowing(ê°€ë ¤ì§)
// =====================================================================
{
   section('3. [ê³ ê¸‰] var vs let/const + Shadowing(ğŸ”¥)');

   /**
    * Shadowing(ê°€ë ¤ì§)ì´ë€?
    * - ê°™ì€ ì´ë¦„ì˜ ë³€ìˆ˜ë¥¼ "ë” ì•ˆìª½ ìŠ¤ì½”í”„"ì—ì„œ ë‹¤ì‹œ ì„ ì–¸í•˜ë©´ ë°”ê¹¥ ë³€ìˆ˜ë¥¼ ê°€ë¦°ë‹¤.
    * ì™œ ì¤‘ìš”?
    * - ë””ë²„ê¹…ì—ì„œ "ê°’ì´ ì™œ ë°”ë€Œì—ˆì§€?"ê°€ ì•„ë‹ˆë¼ "ë‹¤ë¥¸ ë³€ìˆ˜"ì˜€ë˜ ê²½ìš°ê°€ ë§ë‹¤. ğŸ›¡ï¸
    */

   const name = 'global';

   function showShadowing() {
      const name = 'function';
      {
         const name = 'block';
         console.log('block name:', name);
      }
      console.log('function name:', name);
   }

   console.log('global name:', name);
   showShadowing();

   /**
    * var vs let/const
    * - var: í•¨ìˆ˜ ìŠ¤ì½”í”„ë§Œ ë§Œë“ ë‹¤(ë¸”ë¡ ìŠ¤ì½”í”„ ì—†ìŒ) â†’ for/if ë¸”ë¡ ë°–ìœ¼ë¡œ ìƒˆì–´ ë‚˜ì˜¬ ìˆ˜ ìˆìŒ
    * - let/const: ë¸”ë¡ ìŠ¤ì½”í”„ë¥¼ ë§Œë“ ë‹¤ â†’ ì˜ë„ì¹˜ ì•Šì€ ë³€ìˆ˜ ì˜¤ì—¼ ë°©ì§€(í˜„ëŒ€ JS ê¸°ë³¸) â­
    */

   // varëŠ” ë¸”ë¡ì„ ë¬´ì‹œí•œë‹¤(í•¨ìˆ˜ ë°–ì´ë©´ ì‚¬ì‹¤ìƒ ì „ì—­ ì˜¤ì—¼)
   for (var i = 0; i < 3; i++) {
      // ...
   }
   console.log('var i leaked:', i); // 3 âœ… (ë¸”ë¡ ë°–ìœ¼ë¡œ ìƒˆì–´ ë‚˜ì˜´)

   // letì€ ë¸”ë¡ ìŠ¤ì½”í”„ë¼ì„œ ë°–ì— ì˜í–¥ ì—†ìŒ
   for (let j = 0; j < 3; j++) {
      // ...
   }
   // console.log(j); // âŒ ReferenceError
}

// =====================================================================
// 3.5) [ê³ ê¸‰] ğŸ”¥ í˜¸ì´ìŠ¤íŒ… & TDZ: "ì„ ì–¸ì€ ëŒì–´ì˜¬ë ¤ì§€ì§€ë§Œ" ì ‘ê·¼ì€ ë‹¤ë¥´ë‹¤
// =====================================================================
{
   section('3.5 [ê³ ê¸‰] Hoisting & TDZ(ğŸ”¥ ë©´ì ‘ í•¨ì •)');

   /**
    * ë©´ì ‘ í•¨ì • í¬ì¸íŠ¸:
    * - "í˜¸ì´ìŠ¤íŒ…"ì€ ì„ ì–¸ì´ ìŠ¤ì½”í”„ ìƒë‹¨ì— ë“±ë¡ë˜ëŠ” í˜„ìƒ
    * - var: ì„ ì–¸ + undefined ì´ˆê¸°í™”ê¹Œì§€ ë˜ì–´ì„œ ì„ ì–¸ ì „ ì ‘ê·¼ì´ undefined
    * - let/const: ì„ ì–¸ì€ ë˜ì§€ë§Œ TDZ(Temporal Dead Zone) ë•Œë¬¸ì— ì„ ì–¸ ì „ ì ‘ê·¼ì€ ReferenceError
    */

   // var: undefined
   console.log('var before:', v);
   var v = 10;
   console.log('var after:', v);

   // let/const: TDZ
   try {
      // eslint-disable-next-line no-use-before-define
      console.log(l);
   } catch (e) {
      console.log('let TDZ error:', e.message);
   }
   let l = 20;
   console.log('let after:', l);

   // í•¨ìˆ˜ ì„ ì–¸ë¬¸: "ì „ì²´ê°€" í˜¸ì´ìŠ¤íŒ…(ë°”ë¡œ í˜¸ì¶œ ê°€ëŠ¥)
   console.log('declared function:', declared());
   function declared() {
      return 'I am hoisted function declaration';
   }

   // í•¨ìˆ˜ í‘œí˜„ì‹(íŠ¹íˆ const): ë³€ìˆ˜ëŠ” TDZ, í•¨ìˆ˜ëŠ” ê·¸ ì•ˆì— ë‹´ê¸´ ê°’ì´ë¼ ë” ëŠ¦ê²Œ ì‚¬ìš© ê°€ëŠ¥
   try {
      // eslint-disable-next-line no-use-before-define
      console.log(expr());
   } catch (e) {
      console.log('function expression error:', e.message);
   }

   const expr = function () {
      return 'I am function expression';
   };
   console.log('function expression after:', expr());
}

// =====================================================================
// 4) [ì‹¤ë¬´íŒ¨í„´] â­ í´ë¡œì €: ìŠ¤ì½”í”„ì˜ ê²°ê³¼ë¬¼ (ë©´ì ‘+ì‹¤ë¬´ ë‘˜ ë‹¤)
// =====================================================================
{
   section('4. [ì‹¤ë¬´íŒ¨í„´] Closure(â­ğŸ”¥)');

   /**
    * í´ë¡œì €ë€?
    * - "í•¨ìˆ˜"ê°€ ìì‹ ì˜ ë°”ê¹¥ ìŠ¤ì½”í”„ ë³€ìˆ˜ë¥¼ ê³„ì† ì°¸ì¡°í•  ìˆ˜ ìˆëŠ” í˜„ìƒ
    * ì™œ ì¤‘ìš”?
    * - ìƒíƒœ ì€ë‹‰(ìº¡ìŠí™”), ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬, React hooks, debounce/throttleì— ë‹¤ ë“¤ì–´ê° â­
    */

   function createCounter() {
      let count = 0; // ì´ ë³€ìˆ˜ë¥¼ ë°”ê¹¥ì—ì„œ ì§ì ‘ ëª» ê±´ë“œë¦¬ê²Œ "ìˆ¨ê¸°ëŠ”" íš¨ê³¼

      return function increase() {
         count += 1;
         return count;
      };
   }

   const counterA = createCounter();
   const counterB = createCounter();

   console.log('A:', counterA()); // 1
   console.log('A:', counterA()); // 2
   console.log('B:', counterB()); // 1 (ì„œë¡œ ë‹¤ë¥¸ ìŠ¤ì½”í”„)

   /**
    * ë©´ì ‘ ë‹¨ê³¨: for + var + setTimeout
    * - ì™œ ì „ë¶€ ê°™ì€ ìˆ«ìê°€ ì°íˆë‚˜?
    *   varëŠ” ë¸”ë¡ ìŠ¤ì½”í”„ê°€ ì—†ê³ , ì½œë°±ì´ ì‹¤í–‰ë  ë•Œ ì´ë¯¸ iê°€ ë§ˆì§€ë§‰ ê°’ì´ê¸° ë•Œë¬¸
    */

   // (ë‚˜ìœ ì˜ˆ) - ê²°ê³¼: 3,3,3
   for (var k = 0; k < 3; k++) {
      setTimeout(() => console.log('var timeout:', k), 0);
   }

   // (ì •ë‹µ 1) let ì‚¬ìš© - ê²°ê³¼: 0,1,2
   for (let k = 0; k < 3; k++) {
      setTimeout(() => console.log('let timeout:', k), 0);
   }

   // (ì •ë‹µ 2) IIFEë¡œ ìŠ¤ì½”í”„ ìº¡ì²˜(ë ˆê±°ì‹œ í•´ê²°ë²•) - ê²°ê³¼: 0,1,2
   for (var k2 = 0; k2 < 3; k2++) {
      (function (captured) {
         setTimeout(() => console.log('iife timeout:', captured), 0);
      })(k2);
   }
}

// =====================================================================
// 4.5) [ì‹¬í™”] ğŸ”¥ thisëŠ” "ìŠ¤ì½”í”„"ê°€ ì•„ë‹ˆë‹¤ (ìì£¼ í—·ê°ˆë¦¼)
// =====================================================================
{
   section('4.5 [ì‹¬í™”] thisëŠ” ìŠ¤ì½”í”„ê°€ ì•„ë‹ˆë‹¤(ğŸ”¥)');

   /**
    * ì™œ í—·ê°ˆë¦¬ë‚˜?
    * - ë‘˜ ë‹¤ "ì–´ë””ë¥¼ ë°”ë¼ë³´ëŠ”ê°€" ê°™ì€ ëŠë‚Œì´ë¼ ì„ì¸ë‹¤.
    *
    * êµ¬ë¶„:
    * - ìŠ¤ì½”í”„: ë³€ìˆ˜ë¥¼ ì–´ë””ì„œ ì°¾ëŠ”ì§€(ì •ì , ë ‰ì‹œì»¬)
    * - this: í•¨ìˆ˜ë¥¼ "ì–´ë–»ê²Œ í˜¸ì¶œí–ˆëŠ”ì§€"ì— ë”°ë¼ ë‹¬ë¼ì§€ëŠ” ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸(ë™ì )
    */

   const obj = {
      name: 'ì•„ì´ë¸Œ',
      show() {
         console.log('this.name:', this.name);
      },
   };

   obj.show(); // this -> obj

   const detached = obj.show;
   detached(); // this -> undefined(ì—„ê²© ëª¨ë“œ)/ì „ì—­(ëŠìŠ¨)ì¼ ìˆ˜ ìˆìŒ
}

// =====================================================================
// 5) [í•µì‹¬ì •ë¦¬] ë³µìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸ 12ê°œ âœ…
// =====================================================================
{
   section('5. [í•µì‹¬ì •ë¦¬] ë³µìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸ 12ê°œ âœ…');

   const checklist = [
      'ìŠ¤ì½”í”„ëŠ” "ë³€ìˆ˜ ì ‘ê·¼ ê°€ëŠ¥ ë²”ìœ„" ê·œì¹™ì´ë‹¤. ğŸ”¥',
      'JSëŠ” ë ‰ì‹œì»¬ ìŠ¤ì½”í”„: ì„ ì–¸ ìœ„ì¹˜ê°€ ìƒìœ„ ìŠ¤ì½”í”„ë¥¼ ê²°ì •í•œë‹¤. ğŸ”¥',
      'ì‹ë³„ì íƒìƒ‰ì€ ìŠ¤ì½”í”„ ì²´ì¸ìœ¼ë¡œ í˜„ì¬â†’ë°”ê¹¥â†’ì „ì—­ ìˆœì„œë¡œ ì§„í–‰ëœë‹¤. â­',
      'shadowingì€ ë°”ê¹¥ ë³€ìˆ˜ë¥¼ ê°€ë¦¬ëŠ” ì¬ì„ ì–¸ì´ë©° ë””ë²„ê¹… í¬ì¸íŠ¸ë‹¤. ğŸ›¡ï¸',
      'varëŠ” í•¨ìˆ˜ ìŠ¤ì½”í”„ë§Œ ë§Œë“¤ê³  ë¸”ë¡ ìŠ¤ì½”í”„ê°€ ì—†ë‹¤. ğŸ”¥',
      'let/constëŠ” ë¸”ë¡ ìŠ¤ì½”í”„ + TDZë¡œ ì„ ì–¸ ì „ ì ‘ê·¼ì„ ë§‰ëŠ”ë‹¤. â­ğŸ›¡ï¸',
      'varëŠ” ì„ ì–¸ ì „ ì ‘ê·¼ ì‹œ undefined(ì´ˆê¸°í™”ë¨)ì¼ ìˆ˜ ìˆë‹¤. ğŸ”¥',
      'let/constëŠ” TDZ ë•Œë¬¸ì— ì„ ì–¸ ì „ ì ‘ê·¼ ì‹œ ReferenceErrorë‹¤. ğŸ”¥',
      'í•¨ìˆ˜ ì„ ì–¸ë¬¸ì€ ì „ì²´ê°€ í˜¸ì´ìŠ¤íŒ…ë˜ì–´ ì„ ì–¸ ì „ í˜¸ì¶œì´ ê°€ëŠ¥í•˜ë‹¤. ğŸ”¥',
      'í´ë¡œì €ëŠ” í•¨ìˆ˜ê°€ ë°”ê¹¥ ë³€ìˆ˜ë¥¼ ê¸°ì–µí•˜ëŠ” í˜„ìƒìœ¼ë¡œ ì‹¤ë¬´ì—ì„œë„ ë§¤ìš° ìì£¼ ì“°ì¸ë‹¤. â­',
      'for+var+ë¹„ë™ê¸° ì½œë°±ì€ ê°’ì´ ë§ˆì§€ë§‰ìœ¼ë¡œ ë¬¶ì´ê¸° ì‰¬ì›Œ let/IIFEë¡œ í•´ê²°í•œë‹¤. ğŸ›¡ï¸',
      'thisëŠ” ìŠ¤ì½”í”„ê°€ ì•„ë‹ˆë¼ í˜¸ì¶œ ë°©ì‹ì— ë”°ë¼ ë°”ë€ŒëŠ” ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ë‹¤. ğŸ”¥',
   ];

   checklist.forEach((item, idx) => {
      console.log(`${String(idx + 1).padStart(2, '0')}. ${item}`);
   });
}

console.log(`\n${line()}`);
console.log('Scope ìµœì¢… í…œí”Œë¦¿ ë! âœ…');
console.log(line());
