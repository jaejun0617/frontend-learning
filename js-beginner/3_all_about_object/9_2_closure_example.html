<!doctype html>
<html lang="ko">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>9_2 Closure Example - Counter Demo</title>
      <style>
         body {
            font-family:
               system-ui,
               -apple-system,
               Segoe UI,
               Roboto,
               Helvetica,
               Arial,
               sans-serif;
            padding: 24px;
            line-height: 1.6;
         }
         .wrap {
            max-width: 720px;
            margin: 0 auto;
         }
         .card {
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px;
            margin-top: 16px;
         }
         button {
            padding: 10px 14px;
            border-radius: 10px;
            border: 1px solid #d1d5db;
            background: white;
            cursor: pointer;
         }
         button:active {
            transform: translateY(1px);
         }
         code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 6px;
         }
         .row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
         }
         .big {
            font-size: 22px;
            font-weight: 700;
         }
         .hint {
            opacity: 0.8;
         }
         ul {
            margin: 8px 0 0;
            padding-left: 18px;
         }
      </style>
   </head>
   <body>
      <div class="wrap">
         <h1>Closure Demo (상태를 기억하는 함수)</h1>
         <p class="hint">
            버튼을 눌러도 <code>count</code>가 유지되는 이유가 "클로저"입니다.
            콘솔도 같이 확인하세요.
         </p>

         <div class="card">
            <div class="row">
               <span class="big" id="countA">A: 0</span>
               <button id="incA">A +1</button>
               <button id="resetA">A reset</button>
            </div>
            <p class="hint">A는 A만의 클로저 상태를 가집니다.</p>
         </div>

         <div class="card">
            <div class="row">
               <span class="big" id="countB">B: 0</span>
               <button id="incB">B +1</button>
               <button id="resetB">B reset</button>
            </div>
            <p class="hint">B는 B만의 클로저 상태를 가집니다(A와 독립).</p>
         </div>

         <div class="card">
            <h2>핵심 포인트</h2>
            <ul>
               <li>
                  <b>클로저</b>는 함수가 바깥 변수를 <b>참조</b>해서 "기억"하는
                  현상
               </li>
               <li>
                  함수를 반환하면 바깥 함수는 끝나도, 반환된 함수가 변수 참조를
                  유지
               </li>
               <li>그래서 카운터, 상태 은닉, 이벤트 핸들러에 자주 쓰임 ⭐</li>
            </ul>
         </div>
      </div>

      <script>
         console.clear?.();

         // ------------------------------------------------------------
         // 클로저로 만드는 "카운터"
         // ------------------------------------------------------------
         function createCounter(label) {
            let count = 0; // ✅ 이게 클로저로 유지되는 "private state"

            const get = () => count;
            const inc = () => (count += 1);
            const reset = () => (count = 0);

            console.log(`[${label}] counter created`);

            return { get, inc, reset };
         }

         const counterA = createCounter('A');
         const counterB = createCounter('B');

         const $countA = document.getElementById('countA');
         const $countB = document.getElementById('countB');

         const render = () => {
            $countA.textContent = `A: ${counterA.get()}`;
            $countB.textContent = `B: ${counterB.get()}`;
         };

         document.getElementById('incA').addEventListener('click', () => {
            console.log('A inc ->', counterA.inc());
            render();
         });

         document.getElementById('resetA').addEventListener('click', () => {
            console.log('A reset');
            counterA.reset();
            render();
         });

         document.getElementById('incB').addEventListener('click', () => {
            console.log('B inc ->', counterB.inc());
            render();
         });

         document.getElementById('resetB').addEventListener('click', () => {
            console.log('B reset');
            counterB.reset();
            render();
         });

         render();
      </script>
   </body>
</html>
