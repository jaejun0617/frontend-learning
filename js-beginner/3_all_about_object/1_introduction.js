/**
 * =====================================================================
 * JavaScript ê°ì²´ ìƒì„± - í•™ìŠµ + ì‹¤ë¬´ í…œí”Œë¦¿ (2026)
 * =====================================================================
 * â­ = ì‹¤ë¬´ì—ì„œ ìì£¼ ì”€ / ğŸ”¥ = ì¤‘ìš”Â·ìµœì‹  ê´€ì  / ğŸ›¡ï¸ = ë°©ì–´ì  ì½”ë”©(Safety)
 *
 * [í•µì‹¬ì •ë¦¬(ë¨¼ì € ì½ê¸°) ğŸ”¥]
 * 1) ê°€ì¥ ë§ì´ ì“°ëŠ” ê±´ 2ê°œ:
 *    - â­ Object Literal({}) : ì„¤ì •/ê°„ë‹¨ DTO/ì„ì‹œ ë°ì´í„°
 *    - â­ Class + Private(#) + Static Factory : ì‹¤ë¬´ "ë„ë©”ì¸ ëª¨ë¸" ì •ë‹µ
 * 2) ìƒì„±ì í•¨ìˆ˜(function + new)ëŠ” ë ˆê±°ì‹œ(ë©´ì ‘/ì´í•´ìš©). ì‹¤ë¬´ ì‹ ê·œ ì½”ë“œëŠ” classë¡œ.
 * 3) íŒ©í† ë¦¬ í•¨ìˆ˜ëŠ” ê°€ë³ê²Œ ì“¸ ìˆ˜ ìˆì§€ë§Œ, ë©”ì„œë“œê°€ ë§¤ë²ˆ ìƒˆë¡œ ë§Œë“¤ì–´ì ¸ ë©”ëª¨ë¦¬ ë‚­ë¹„ê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤.
 * 4) ì‹¤ë¬´ëŠ” "ë°ì´í„° ë³´í˜¸ + ê²€ì¦ + ì¼ê´€ëœ ìƒì„±"ì´ í•µì‹¬ì´ë‹¤. (Private + Validation + Factory) ğŸ›¡ï¸
 */

console.clear?.();

// ---------------------------------------------------------------------
// [Utility] ì¶œë ¥ í¬ë§·íŒ… (í•™ìŠµ ê°€ë…ì„±ìš©)
// ---------------------------------------------------------------------
const line = (n = 72) => '='.repeat(n);
const section = (title) => {
   console.log(`\n${line()}`);
   console.log(`â–¶ ${title}`);
   console.log(line());
};

// =====================================================================
// 1) [ì´ˆê¸‰] Object Literal: "ê°€ì¥ ì§ê´€ì ì¸" ê°ì²´
// =====================================================================
{
   section('1. [ì´ˆê¸‰] Object Literal (â­ ê°€ì¥ ë§ì´ ì”€)');

   /**
    * ì™œ Object Literalì„ ì“°ë‚˜?
    * - ë¬¸ë²•ì´ ê°€ì¥ ê°„ë‹¨í•˜ê³ , í•œ ë²ˆ ì“°ê³  ëë‚˜ëŠ” ë°ì´í„°ì— ìµœì 
    * - ì„¤ì •ê°’(config), í™”ë©´ í‘œì‹œìš© DTO, í…ŒìŠ¤íŠ¸ìš© ëª©ì—… ë°ì´í„°ì— ìì£¼ ì‚¬ìš© â­
    */

   const simpleProfile = {
      name: 'ì•ˆìœ ì§„',
      year: 2003,

      // ë©”ì„œë“œ ì¶•ì•½í˜•: thisë¥¼ ì‚¬ìš©í•  ë•Œ ê°€ì¥ ê¸°ë³¸ì´ ë˜ëŠ” í˜•íƒœ
      greet() {
         console.log(`ì•ˆë…•í•˜ì„¸ìš”, ${this.name}ì…ë‹ˆë‹¤!`);
      },
   };

   simpleProfile.greet();

   // ğŸ›¡ï¸ ì‹¤ë¬´ íŒ: "ë³€í•˜ì§€ ì•Šì•„ì•¼ í•˜ëŠ”" ì„¤ì •ì€ freezeë¡œ ê³ ì •
   // ì™œ? ëˆ„êµ°ê°€ ì‹¤ìˆ˜ë¡œ ê°’ì„ ë°”ê¾¸ë©´ ë””ë²„ê¹…ì´ ì–´ë ¤ì›Œì§
   const config = Object.freeze({ theme: 'dark', retry: 3 });
   console.log('config.theme:', config.theme);
}

// =====================================================================
// 2) [ì¤‘ê¸‰] ìƒì„±ì í•¨ìˆ˜(ë ˆê±°ì‹œ): classì˜ ì¡°ìƒë‹˜
// =====================================================================
{
   section('2. [ì¤‘ê¸‰] Constructor Function (ë ˆê±°ì‹œ/ë©´ì ‘ìš©)');

   /**
    * ì™œ ì•Œì•„ì•¼ í•˜ë‚˜?
    * - class ë¬¸ë²•ë„ ë‚´ë¶€ì ìœ¼ë¡œëŠ” prototype ê¸°ë°˜ì´ë¼, ì›ë¦¬ë¥¼ ì´í•´í•˜ë©´ ì‘ìš©ì´ ì‰¬ì›€ ğŸ”¥
    *
    * ì™œ ì‹¤ë¬´ì—ì„  ì§€ì–‘?
    * - ë¬¸ë²•/ê·œì¹™ì´ ëŠìŠ¨í•´ì„œ ì‹¤ìˆ˜í•˜ê¸° ì‰½ê³ , ì‹ ê·œ ì½”ë“œëŠ” classê°€ ë” ëª…í™•í•¨
    */

   function LegacyIdol(name, year) {
      this.name = name;
      this.year = year;
   }

   // â­ ë©”ì„œë“œ ê³µìœ ì˜ í•µì‹¬: prototypeì— ë¶™ì´ë©´ ì¸ìŠ¤í„´ìŠ¤ë¼ë¦¬ í•¨ìˆ˜ë¥¼ ê³µìœ í•œë‹¤(ë©”ëª¨ë¦¬ ì ˆì•½)
   LegacyIdol.prototype.dance = function () {
      console.log(`${this.name}ì´(ê°€) ì¶¤ì„ ì¶¥ë‹ˆë‹¤.`);
   };

   const legacyMember = new LegacyIdol('ê°€ì„', 2002);
   legacyMember.dance();

   // ê³µìœ  í™•ì¸
   const a = new LegacyIdol('ë ˆì´', 2004);
   const b = new LegacyIdol('ë¦¬ì¦ˆ', 2004);
   console.log('í•¨ìˆ˜ ê³µìœ  ì—¬ë¶€:', a.dance === b.dance); // true âœ…
}

// =====================================================================
// 3) [ê³ ê¸‰] Factory Function: ê°€ë³ê²Œ ì“°ë˜, "ë©”ì„œë“œ ì¬ìƒì„±"ì— ì£¼ì˜
// =====================================================================
{
   section('3. [ê³ ê¸‰] Factory Function (ê°€ë²¼ìš´ ìœ í‹¸, ë‹¨ì ë„ ê°™ì´)');

   /**
    * ì™œ íŒ©í† ë¦¬ í•¨ìˆ˜ë¥¼ ì“°ë‚˜?
    * - class ì—†ì´ë„ ê°ì²´ë¥¼ ì‰½ê²Œ ë§Œë“¤ì–´ë‚¼ ìˆ˜ ìˆìŒ
    * - ë‹¨ìˆœ ìœ í‹¸/ì‘ì€ ëª¨ë“ˆ/í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œ ë¹ ë¥´ê²Œ ì‚¬ìš© ê°€ëŠ¥
    *
    * ë‹¨ì (ğŸ”¥):
    * - ê°ì²´ë¥¼ ë§Œë“¤ ë•Œë§ˆë‹¤ ë©”ì„œë“œ(í•¨ìˆ˜)ê°€ ìƒˆë¡œ ìƒì„±ë  ìˆ˜ ìˆë‹¤ â†’ ë©”ëª¨ë¦¬ ë‚­ë¹„
    */

   const createIdolUtil = (name, year) => {
      return {
         name,
         year,

         // âš ï¸ ì£¼ì˜: ì—¬ê¸°ì„œ introduceëŠ” "ë§¤ë²ˆ ìƒˆ í•¨ìˆ˜"ê°€ ë§Œë“¤ì–´ì§ˆ ìˆ˜ ìˆìŒ
         introduce: () => console.log(`[Factory] ì €ëŠ” ${name}ì…ë‹ˆë‹¤.`),
      };
   };

   const factoryMember1 = createIdolUtil('ë ˆì´', 2004);
   const factoryMember2 = createIdolUtil('ë¦¬ì¦ˆ', 2004);

   console.log(
      'í•¨ìˆ˜ ê³µìœ  ì—¬ë¶€:',
      factoryMember1.introduce === factoryMember2.introduce,
   ); // false âŒ (ì„œë¡œ ë‹¤ë¥¸ í•¨ìˆ˜)

   /**
    * ğŸ›¡ï¸ ê°œì„ (ì‹¤ë¬´ íŒ): ë©”ì„œë“œë¥¼ ê³µìœ í•˜ê³  ì‹¶ìœ¼ë©´ "ê³µìœ  í•¨ìˆ˜"ë¥¼ ë°–ìœ¼ë¡œ ë¹¼ê¸°
    * ì™œ? í•¨ìˆ˜ëŠ” í•œ ë²ˆë§Œ ë§Œë“¤ê³ , ì—¬ëŸ¬ ê°ì²´ì—ì„œ ì¬ì‚¬ìš© ê°€ëŠ¥
    */

   const sharedIntroduce = function () {
      console.log(`[Factory+Shared] ì €ëŠ” ${this.name}ì…ë‹ˆë‹¤.`);
   };

   const createIdolUtilShared = (name, year) => ({
      name,
      year,
      introduce: sharedIntroduce,
   });

   const c = createIdolUtilShared('ì¥ì›ì˜', 2004);
   const d = createIdolUtilShared('ì´ì„œ', 2007);
   console.log('ê³µìœ  í•¨ìˆ˜ ì—¬ë¶€:', c.introduce === d.introduce); // true âœ…
   c.introduce();
}

// =====================================================================
// 4) [ì‹¤ë¬´íŒ¨í„´] â­ Class + Private + Validation + Static Factory (ìµœì¢… ì •ë‹µ)
// =====================================================================
{
   section('4. [ì‹¤ë¬´íŒ¨í„´] Class Pattern (â­ ì‹¤ë¬´ ìµœì¢… ì •ë‹µ)');

   /**
    * ì‹¤ë¬´ì—ì„œ classë¥¼ ì“°ëŠ” ì´ìœ :
    * - Private(#)ë¡œ ë°ì´í„° ë³´í˜¸ (ì™¸ë¶€ì—ì„œ ë§ˆìŒëŒ€ë¡œ ìˆ˜ì • ëª»í•˜ê²Œ) ğŸ›¡ï¸
    * - ìƒì„± ì‹œì ì— ê²€ì¦(Validation)ìœ¼ë¡œ ë¶ˆëŸ‰ ë°ì´í„° ì°¨ë‹¨ ğŸ›¡ï¸
    * - Static Factoryë¡œ ìƒì„± ê·œì¹™ì„ í†µì¼(ì…ë ¥ í˜•íƒœê°€ ë‹¬ë¼ë„ í•œ êµ°ë°ë¡œ) â­
    */

   class IdolEntity {
      #name;
      #year;

      constructor({ name, year }) {
         // ğŸ›¡ï¸ ê²€ì¦ì€ "ìƒì„± ì‹œì "ì— í•˜ëŠ” ê²Œ ì œì¼ ì‹¸ê³  ì•ˆì „í•¨
         // ì™œ? ì˜ëª»ëœ ê°ì²´ê°€ ì‹œìŠ¤í…œ ì•ˆìœ¼ë¡œ ë“¤ì–´ì˜¤ë©´, ë‚˜ì¤‘ì—” ì–´ë””ì„œ ê¹¨ì¡ŒëŠ”ì§€ ì¶”ì ì´ ì–´ë µë‹¤
         if (typeof name !== 'string' || name.trim().length < 1) {
            throw new TypeError(`ì˜ëª»ëœ name: ${name}`);
         }
         if (!Number.isFinite(year)) {
            throw new TypeError(`ì˜ëª»ëœ year: ${year}`);
         }

         this.#name = name.trim();
         this.#year = year;
      }

      // â­ Getter: ì½ê¸° ì „ìš© ì¸í„°í˜ì´ìŠ¤ ì œê³µ
      get name() {
         return this.#name;
      }

      get year() {
         return this.#year;
      }

      // ğŸ”¥ íŒŒìƒ ë°ì´í„°ëŠ” getterë¡œ ì œê³µí•˜ë©´ "í•­ìƒ ìµœì‹ "ì´ ëœë‹¤
      get age() {
         return new Date().getFullYear() - this.#year;
      }

      // â­ ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œ: ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ê°€ ê³µìœ (ë©”ëª¨ë¦¬ íš¨ìœ¨)
      introduce() {
         return `[Class] ${this.#year}ë…„ìƒ ${this.#name}ì…ë‹ˆë‹¤. (ëŒ€ëµ ${this.age}ì‚´)`;
      }

      // â­ toJSON: ë¡œê·¸/ì „ì†¡/ë””ë²„ê¹…ì— ìœ ìš©
      toJSON() {
         return { name: this.#name, year: this.#year, age: this.age };
      }

      // ğŸ­ Static Factory: ë°ì´í„° â†’ ì•ˆì „í•œ ê°ì²´ë¡œ ë³€í™˜
      static from(data) {
         return new IdolEntity(data);
      }

      // ğŸ”¥ ì‹¤ë¬´ì‹: "ì‹¤íŒ¨ë¥¼ ê°ì‹¼" safe factory
      static safeFrom(data) {
         try {
            return { ok: true, value: IdolEntity.from(data) };
         } catch (e) {
            return {
               ok: false,
               error: e instanceof Error ? e.message : 'unknown error',
            };
         }
      }

      // â­ ë¶ˆë³€ì„± ì„ í˜¸: setter ëŒ€ì‹  ìƒˆ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜(withX)
      withName(nextName) {
         return IdolEntity.from({ name: nextName, year: this.#year });
      }
   }

   // --- ì‹¤ë¬´ ì‹œë®¬ë ˆì´ì…˜ ---

   // 1) APIì—ì„œ ë„˜ì–´ì˜¨ ë‚ ê²ƒì˜ ë°ì´í„°(ë¶ˆëŸ‰ ì„ì„)
   const rawDataList = [
      { name: 'ì¥ì›ì˜', year: 2004 },
      { name: 'ì´ì„œ', year: 2007 },
      { name: 'ì˜¤ë¥˜ë‚¨', year: 'ëª°ë¼' },
   ];

   // 2) ì•ˆì „í•˜ê²Œ ë³€í™˜(Map)
   const results = rawDataList.map((data) => IdolEntity.safeFrom(data));

   // 3) ì„±ê³µë§Œ ì¶”ì¶œ(Filter)
   const safeMembers = results.filter((r) => r.ok).map((r) => r.value);

   // 4) ì‹¤íŒ¨ëŠ” ë”°ë¡œ ë¡œê¹…
   results
      .filter((r) => !r.ok)
      .forEach((r) => console.warn(`âš ï¸ ë°ì´í„° ìŠ¤í‚µ: ${r.error}`));

   console.log(`\nì´ ${safeMembers.length}ëª…ì˜ ë©¤ë²„ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`);
   safeMembers.forEach((m) => console.log(m.introduce()));

   // 5) ë©”ëª¨ë¦¬ íš¨ìœ¨ ì¦ëª…(ë©”ì„œë“œ ê³µìœ )
   const memberA = safeMembers[0];
   const memberB = safeMembers[1];
   console.log('í•¨ìˆ˜ ê³µìœ  ì—¬ë¶€:', memberA.introduce === memberB.introduce); // true âœ…

   // 6) ë¶ˆë³€ì„± ì˜ˆì‹œ
   const renamed = memberA.withName('ë¦¬ë„¤ì„');
   console.log('ì›ë³¸:', memberA.toJSON());
   console.log('ìƒˆ ê°ì²´:', renamed.toJSON());
}

// =====================================================================
// 5) [í•µì‹¬ì •ë¦¬] ë³µìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸ 12ê°œ âœ…
// =====================================================================
{
   section('5. [í•µì‹¬ì •ë¦¬] ë³µìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸ 12ê°œ âœ…');

   const checklist = [
      'Object Literal({})ì€ ì„¤ì •/ê°„ë‹¨ DTO/ëª©ì—…ì— ê°€ì¥ ë§ì´ ì“´ë‹¤. â­',
      'ë³€í•˜ì§€ ì•Šì•„ì•¼ í•˜ëŠ” ì„¤ì •ì€ Object.freezeë¡œ ì‹¤ìˆ˜ ë°©ì§€í•  ìˆ˜ ìˆë‹¤. ğŸ›¡ï¸',
      'ìƒì„±ì í•¨ìˆ˜ëŠ” ë ˆê±°ì‹œì§€ë§Œ prototype ì›ë¦¬ ì´í•´ì— ë„ì›€ ëœë‹¤. ğŸ”¥',
      'prototypeì— ë©”ì„œë“œë¥¼ ë¶™ì´ë©´ ì¸ìŠ¤í„´ìŠ¤ ê°„ í•¨ìˆ˜ê°€ ê³µìœ ëœë‹¤. ğŸ”¥',
      'íŒ©í† ë¦¬ í•¨ìˆ˜ëŠ” ê°„ë‹¨í•˜ì§€ë§Œ ë©”ì„œë“œê°€ ë§¤ë²ˆ ìƒˆë¡œ ìƒê¸¸ ìˆ˜ ìˆë‹¤(ë©”ëª¨ë¦¬ ë‚­ë¹„). ğŸ”¥',
      'íŒ©í† ë¦¬ì—ì„œ ë©”ì„œë“œ ê³µìœ ê°€ í•„ìš”í•˜ë©´ í•¨ìˆ˜ë¥¼ ì™¸ë¶€ë¡œ ë¹¼ì„œ ì¬ì‚¬ìš©í•œë‹¤. â­',
      'ì‹¤ë¬´ ë„ë©”ì¸ ëª¨ë¸ì€ Class + Private(#)ë¡œ ë°ì´í„° ë³´í˜¸ë¥¼ í•œë‹¤. â­ğŸ›¡ï¸',
      'ê²€ì¦(Validation)ì€ ìƒì„± ì‹œì ì— í•˜ëŠ” ê²Œ ê°€ì¥ ì•ˆì „í•˜ê³  ì‹¸ë‹¤. ğŸ›¡ï¸',
      'Static Factory(from)ëŠ” ìƒì„± ê·œì¹™ì„ í•œ ê³³ìœ¼ë¡œ ëª¨ì•„ ì¼ê´€ì„±ì„ ë§Œë“ ë‹¤. â­',
      'safeFromì²˜ëŸ¼ ì‹¤íŒ¨ë¥¼ ê°ì‹¸ë©´ ë¡œê·¸/ë³µêµ¬ íë¦„ì„ ë§Œë“¤ê¸° ì‰½ë‹¤. ğŸ”¥',
      'íŒŒìƒ ë°ì´í„°(age ë“±)ëŠ” getterë¡œ ì œê³µí•˜ë©´ í•­ìƒ ìµœì‹ ì´ë©° í˜¸ì¶œë¶€ê°€ ê¹”ë”í•´ì§„ë‹¤. ğŸ”¥',
      'Setter ëŒ€ì‹  withXë¡œ ìƒˆ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•˜ë©´ ë¶ˆë³€ì„± íë¦„ì— ë§ë‹¤. â­',
   ];

   checklist.forEach((item, idx) => {
      console.log(`${String(idx + 1).padStart(2, '0')}. ${item}`);
   });
}

console.log(`\n${line()}`);
console.log('Object Creation ìµœì¢… í…œí”Œë¦¿ ë! âœ…');
console.log(line());
