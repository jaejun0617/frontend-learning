/**
 * =====================================================================
 * Async Programming Theory - í•™ìŠµ+ì‹¤ë¬´ í…œí”Œë¦¿ (2026)
 * =====================================================================
 * â­ = ì‹¤ë¬´ ë¹ˆì¶œ / ğŸ”¥ = ë©´ì ‘ í•µì‹¬ / ğŸ›¡ï¸ = ì‹¤ìˆ˜ ë°©ì§€
 *
 * [ë§¨ ìœ„ ê²°ë¡ : ì§„ì§œ ì¤‘ìš” vs ê°œë…ë§Œ âœ…]
 * âœ… ì§„ì§œ ì¤‘ìš” â­ğŸ”¥
 * - JSëŠ” "ì‹±ê¸€ ìŠ¤ë ˆë“œ"ì§€ë§Œ, ë¹„ë™ê¸°ëŠ” "ì´ë²¤íŠ¸ ë£¨í”„"ë¡œ ì²˜ë¦¬í•œë‹¤.
 * - Call Stack(ì§€ê¸ˆ ì‹¤í–‰) + Web APIs(íƒ€ì´ë¨¸/ë„¤íŠ¸ì›Œí¬) + Task Queue + Microtask Queue + Event Loop
 * - Promise.then / queueMicrotaskëŠ” "ë§ˆì´í¬ë¡œíƒœìŠ¤í¬"ë¼ì„œ setTimeout(íƒœìŠ¤í¬)ë³´ë‹¤ ë¨¼ì € ì‹¤í–‰ëœë‹¤. ğŸ”¥
 *
 * â˜‘ï¸ ê°œë…ë§Œ
 * - ìš©ì–´ë¥¼ ì™¸ìš°ê¸°ë³´ë‹¤ "ìˆœì„œ"ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ê²Œ í•µì‹¬
 *
 * [í•µì‹¬ì •ë¦¬(ë¨¼ì € ì½ê¸°) ğŸ”¥]
 * 1) ë™ê¸°: ìœ„ì—ì„œ ì•„ë˜ë¡œ, í•œ ì¤„ ëë‚˜ì•¼ ë‹¤ìŒ ì¤„
 * 2) ë¹„ë™ê¸°: ì§€ê¸ˆì€ ë“±ë¡ë§Œ í•˜ê³ , ë‚˜ì¤‘ì— ì½œë°± ì‹¤í–‰
 * 3) ì‹¤í–‰ ìš°ì„ ìˆœìœ„(ëŒ€ì›ì¹™): Call Stack ë¹„ìš°ê¸° â†’ Microtask â†’ Task
 */

console.clear?.();

// ---------------------------------------------------------------------
// [Utility] ì¶œë ¥ í¬ë§·íŒ…
// ---------------------------------------------------------------------
const line = (n = 86) => '='.repeat(n);
const section = (title) => {
   console.log(`\n${line()}`);
   console.log(`â–¶ ${title}`);
   console.log(line());
};

// =====================================================================
// 1) [ì´ˆê¸‰] ë™ê¸° vs ë¹„ë™ê¸°: "ë“±ë¡"ê³¼ "ì‹¤í–‰"ì„ êµ¬ë¶„í•˜ì
// =====================================================================
{
   section('1. [ì´ˆê¸‰] ë™ê¸° vs ë¹„ë™ê¸° (ë“±ë¡ê³¼ ì‹¤í–‰ì˜ ë¶„ë¦¬)');

   console.log('A: ë™ê¸° ì‹œì‘');

   // setTimeoutì€ "ì§€ê¸ˆ ì‹¤í–‰"ì´ ì•„ë‹ˆë¼ "ë‚˜ì¤‘ì— ì‹¤í–‰ ì˜ˆì•½"ì´ë‹¤.
   setTimeout(() => {
      console.log('C: setTimeout ì½œë°±(íƒœìŠ¤í¬)');
   }, 0);

   console.log('B: ë™ê¸° ë');

   /**
    * ì˜ˆìƒ ìˆœì„œ:
    * A â†’ B â†’ C
    * ì™œ?
    * - ì½œë°±ì€ Task Queueë¡œ ë“¤ì–´ê°€ê³ , ì½œ ìŠ¤íƒì´ ë¹„ì—ˆì„ ë•Œ ì‹¤í–‰ë¨
    */
}

// =====================================================================
// 2) [ì¤‘ê¸‰] ì´ë²¤íŠ¸ ë£¨í”„ í•œ ì¥ ìš”ì•½: Call Stack / Task / Microtask
// =====================================================================
{
   section('2. [ì¤‘ê¸‰] Microtask(Promise) vs Task(setTimeout) ğŸ”¥');

   console.log('1) sync');

   setTimeout(() => {
      console.log('4) task: setTimeout');
   }, 0);

   Promise.resolve().then(() => {
      console.log('3) microtask: Promise.then');
   });

   console.log('2) sync');

   /**
    * ì˜ˆìƒ ìˆœì„œ:
    * 1 â†’ 2 â†’ 3 â†’ 4
    * ì™œ?
    * - syncê°€ ëë‚˜ì„œ stackì´ ë¹„ë©´
    * - microtaskë¥¼ ë¨¼ì € "ì „ë¶€" ë¹„ìš°ê³ 
    * - ê·¸ ë‹¤ìŒ taskë¥¼ ì²˜ë¦¬
    */
}

// =====================================================================
// 3) [ê³ ê¸‰] "ë¸”ë¡œí‚¹" vs "ë…¼ë¸”ë¡œí‚¹"ì„ êµ¬ë¶„í•˜ì ğŸ”¥
// =====================================================================
{
   section('3. [ê³ ê¸‰] ë¸”ë¡œí‚¹(Blocking) vs ë…¼ë¸”ë¡œí‚¹(Non-blocking) ğŸ”¥');

   /**
    * ë¸”ë¡œí‚¹: ì§€ê¸ˆ ì¼ì´ ëë‚  ë•Œê¹Œì§€ ë‹¤ìŒ ì¤„ì´ ëª» ê°(while, ë™ê¸° ë¬´í•œ ë£¨í”„ ë“±)
    * ë…¼ë¸”ë¡œí‚¹: ì¼ì„ ë§¡ê¸°ê³ (setTimeout/ë„¤íŠ¸ì›Œí¬) ë‹¤ìŒ ì¤„ ê³„ì† ì§„í–‰
    *
    * ì™œ ì¤‘ìš”?
    * - ë¸Œë¼ìš°ì €ì—ì„œëŠ” ë¸”ë¡œí‚¹ì´ UI í”„ë¦¬ì¦ˆ(ë©ˆì¶¤)ë¡œ ì´ì–´ì§
    * - Nodeì—ì„œëŠ” ì´ë²¤íŠ¸ ë£¨í”„ê°€ ë§‰í˜€ì„œ ì „ì²´ ì„œë¹„ìŠ¤ê°€ ëŠë ¤ì§
    */

   console.log('ë¸”ë¡œí‚¹ ì˜ˆì‹œëŠ” ì½”ë“œ ì‹¤í–‰ ì¤‘ë‹¨ ìœ„í—˜ì´ ìˆì–´ ì—¬ê¸°ì„œëŠ” ì„¤ëª…ë§Œ! ğŸ›¡ï¸');
}

// =====================================================================
// 4) [ì‹¤ë¬´íŒ¨í„´] â­ ë¹„ë™ê¸° ì‘ì—…ì„ í•¨ìˆ˜ë¡œ ê°ì‹¸ê³ , ì˜¤ë¥˜ë¥¼ 1êµ°ë°ë¡œ ëª¨ìœ¼ê¸°
// =====================================================================
{
   section('4. [ì‹¤ë¬´íŒ¨í„´] ë¹„ë™ê¸° í•¨ìˆ˜ ì„¤ê³„: "ë°˜í™˜"ê³¼ "ì—ëŸ¬"ë¥¼ í‘œì¤€í™” â­');

   /**
    * ì™œ Promiseë¥¼ ì„ í˜¸?
    * - ë°˜í™˜ê°’(ì„±ê³µ) / ì—ëŸ¬(ì‹¤íŒ¨) íë¦„ì„ í‘œì¤€í™” ê°€ëŠ¥
    * - async/awaitë¡œ ì½ê¸° ì‰¬ì›Œì§
    */

   const delay = (ms) => new Promise((resolve) => setTimeout(resolve, ms));

   async function runJob() {
      try {
         console.log('job start');
         await delay(200);
         console.log('job done');
      } catch (e) {
         // ğŸ›¡ï¸ ì‹¤ë¬´: ì—¬ê¸°ì—ì„œ ë¡œê¹…/ì—ëŸ¬ ë¦¬í¬íŒ…ì„ ëª¨ì•„ ê´€ë¦¬
         console.error('job failed:', e);
      }
   }

   runJob();
}

// =====================================================================
// 5) [í•µì‹¬ì •ë¦¬] ë³µìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸ 12ê°œ âœ…
// =====================================================================
{
   section('5. [í•µì‹¬ì •ë¦¬] ë³µìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸ 12ê°œ âœ…');

   const checklist = [
      'JSëŠ” ì‹±ê¸€ ìŠ¤ë ˆë“œì§€ë§Œ ì´ë²¤íŠ¸ ë£¨í”„ë¡œ ë¹„ë™ê¸°ë¥¼ ì²˜ë¦¬í•œë‹¤. ğŸ”¥',
      'ë™ê¸°ëŠ” ìœ„ì—ì„œ ì•„ë˜ë¡œ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ëœë‹¤. â­',
      'ë¹„ë™ê¸°ëŠ” "ì§€ê¸ˆ ë“±ë¡" í›„ "ë‚˜ì¤‘ ì‹¤í–‰"ì´ë‹¤. â­',
      'ì½œ ìŠ¤íƒì´ ë¹„ì–´ì•¼ ì½œë°±ì´ ì‹¤í–‰ëœë‹¤. ğŸ”¥',
      'Task(setTimeout)ë³´ë‹¤ Microtask(Promise.then)ê°€ ìš°ì„ ì´ë‹¤. ğŸ”¥',
      'MicrotaskëŠ” í•œ ë²ˆ ì‹œì‘ë˜ë©´ íë¥¼ "ì „ë¶€" ë¹„ìš°ê³  ë‹¤ìŒìœ¼ë¡œ ê°„ë‹¤. ğŸ”¥',
      'ë¸”ë¡œí‚¹ ì½”ë“œëŠ” UI/ì„œë²„ë¥¼ ë©ˆì¶”ê²Œ ë§Œë“ ë‹¤. ğŸ›¡ï¸',
      'ë¹„ë™ê¸° ì½”ë“œëŠ” ë°˜í™˜(Promise)ìœ¼ë¡œ íë¦„ì„ í‘œì¤€í™”í•˜ëŠ” ê²Œ ì¢‹ë‹¤. â­',
      'try/catchëŠ” async/awaitì—ì„œ ê°€ì¥ ì½ê¸° ì‰¬ìš´ ì—ëŸ¬ ì²˜ë¦¬ ë°©ì‹ì´ë‹¤. â­',
      'ì‹¤ë¬´ì—ì„œëŠ” ì—ëŸ¬ ë¡œê¹…/ë¦¬í¬íŒ… ì§€ì ì„ 1êµ°ë°ë¡œ ëª¨ì•„ë¼. ğŸ›¡ï¸',
      'ë¹„ë™ê¸° ë””ë²„ê¹…ì€ "ìˆœì„œ ì˜ˆì¸¡"ì´ í•µì‹¬ì´ë‹¤(ìŠ¤íƒâ†’ë§ˆì´í¬ë¡œâ†’íƒœìŠ¤í¬). ğŸ”¥',
      'ë©´ì ‘ì—ì„œëŠ” "ì™œ Promiseê°€ ë¨¼ì €ëƒ"ë¥¼ ì´ë²¤íŠ¸ ë£¨í”„ë¡œ ì„¤ëª…í•˜ë©´ ëœë‹¤. ğŸ”¥',
   ];

   checklist.forEach((item, idx) => {
      console.log(`${String(idx + 1).padStart(2, '0')}. ${item}`);
   });
}

console.log(`\n${line()}`);
console.log('Async Theory í…œí”Œë¦¿ ë! âœ…');
console.log(line());
