/**
 * ==========================================
 * Hoisting (í˜¸ì´ìŠ¤íŒ…)
 * ==========================================
 *
 * JavaScriptì—ì„œ ê°€ì¥ ì¤‘ìš”í•˜ê³  í—·ê°ˆë¦¬ëŠ” ê°œë… ì¤‘ í•˜ë‚˜!
 * ë©´ì ‘ì—ì„œë„ ìì£¼ ë‚˜ì˜¤ëŠ” ì§ˆë¬¸
 */

// ==========================================
// 1. í˜¸ì´ìŠ¤íŒ…ì´ë€?
// ==========================================
/**
 * [ì •ì˜]
 * ë³€ìˆ˜/í•¨ìˆ˜ ì„ ì–¸ì´ ìŠ¤ì½”í”„ì˜ ìµœìƒë‹¨ìœ¼ë¡œ ëŒì–´ì˜¬ë ¤ì§€ëŠ” ê²ƒì²˜ëŸ¼ ë™ì‘í•˜ëŠ” í˜„ìƒ
 *
 * [ì¤‘ìš”!]
 * - ì‹¤ì œë¡œ ì½”ë“œê°€ ì´ë™í•˜ëŠ” ê²ƒì´ ì•„ë‹˜
 * - JavaScript ì—”ì§„ì´ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê¸° ì „ì—
 *   ë³€ìˆ˜/í•¨ìˆ˜ ì„ ì–¸ì„ ë¨¼ì € ë©”ëª¨ë¦¬ì— ë“±ë¡í•˜ê¸° ë•Œë¬¸
 */

console.log('='.repeat(40));

// ==========================================
// 2. varì˜ í˜¸ì´ìŠ¤íŒ…
// ==========================================
/**
 * varëŠ” í˜¸ì´ìŠ¤íŒ… ì‹œ:
 * 1) ì„ ì–¸ì´ ìµœìƒë‹¨ìœ¼ë¡œ ì˜¬ë¼ê°
 * 2) undefinedë¡œ ì´ˆê¸°í™”ë¨
 * 3) ë”°ë¼ì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•ŠìŒ (ë¬¸ì œ!)
 */

console.log(legacyName); // undefined (ì—ëŸ¬ ì•„ë‹˜!)
var legacyName = 'ì½”ë“œíŒ©í† ë¦¬';
console.log(legacyName); // ì½”ë“œíŒ©í† ë¦¬

// ìœ„ ì½”ë“œëŠ” JavaScript ì—”ì§„ì´ ì•„ë˜ì²˜ëŸ¼ í•´ì„í•¨
// var legacyName;                // 1. ì„ ì–¸ì´ ìµœìƒë‹¨ìœ¼ë¡œ
// console.log(legacyName);       // 2. undefined ì¶œë ¥
// legacyName = 'ì½”ë“œíŒ©í† ë¦¬';     // 3. í• ë‹¹ì€ ì›ë˜ ìœ„ì¹˜ì—ì„œ
// console.log(legacyName);       // 4. ì½”ë“œíŒ©í† ë¦¬ ì¶œë ¥

console.log('='.repeat(40));

// ==========================================
// 3. let/constì˜ í˜¸ì´ìŠ¤íŒ… (í•µì‹¬!)
// ==========================================
/**
 * ğŸ”¥ ì¤‘ìš”: let/constë„ í˜¸ì´ìŠ¤íŒ…ëœë‹¤!
 *
 * í•˜ì§€ë§Œ varì™€ ë‹¤ë¥¸ ì :
 * 1) ì„ ì–¸ì€ í˜¸ì´ìŠ¤íŒ…ë˜ì§€ë§Œ
 * 2) ì´ˆê¸°í™”ëŠ” ë˜ì§€ ì•ŠìŒ
 * 3) TDZ(Temporal Dead Zone)ì— ë¹ ì§
 * 4) ë”°ë¼ì„œ ReferenceError ë°œìƒ
 */

// âŒ letì˜ í˜¸ì´ìŠ¤íŒ…
// console.log(yuJin); // ReferenceError: Cannot access 'yuJin' before initialization
// let yuJin = 'ì•ˆìœ ì§„';

// âŒ constì˜ í˜¸ì´ìŠ¤íŒ…
// console.log(wonyoung); // ReferenceError: Cannot access 'wonyoung' before initialization
// const wonyoung = 'ì¥ì›ì˜';

console.log('='.repeat(40));

// ==========================================
// 4. TDZ (Temporal Dead Zone) - ë§¤ìš° ì¤‘ìš”!
// ==========================================
/**
 * [TDZë€?]
 * ë³€ìˆ˜ê°€ ì„ ì–¸ë˜ì—ˆì§€ë§Œ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•„ì„œ
 * ì ‘ê·¼í•  ìˆ˜ ì—†ëŠ” êµ¬ê°„
 *
 * [TDZì˜ ì‹œì‘ê³¼ ë]
 * ì‹œì‘: ìŠ¤ì½”í”„ì˜ ì‹œì‘ ì§€ì 
 * ë: ë³€ìˆ˜ê°€ ì´ˆê¸°í™”ë˜ëŠ” ì§€ì 
 */

// TDZ ì‹œì‘
console.log('ìŠ¤ì½”í”„ ì‹œì‘');

// console.log(idol); // âŒ ReferenceError - TDZ êµ¬ê°„!
// TDZ êµ¬ê°„
// TDZ êµ¬ê°„
// TDZ êµ¬ê°„

let idol = 'ì•„ì´ë¸Œ'; // TDZ ë (ì´ˆê¸°í™” ì™„ë£Œ)
console.log(idol); // âœ… ì •ìƒ ë™ì‘

console.log('='.repeat(40));

// ==========================================
// 5. var vs let/const í˜¸ì´ìŠ¤íŒ… ë¹„êµ
// ==========================================

// varì˜ ê²½ìš°
console.log('--- var í˜¸ì´ìŠ¤íŒ… ---');
console.log(varVariable); // undefined (ì—ëŸ¬ ì—†ìŒ)
var varVariable = 'var ë³€ìˆ˜';
console.log(varVariable); // var ë³€ìˆ˜

// letì˜ ê²½ìš°
console.log('--- let í˜¸ì´ìŠ¤íŒ… ---');
// console.log(letVariable); // âŒ ReferenceError
let letVariable = 'let ë³€ìˆ˜';
console.log(letVariable); // let ë³€ìˆ˜

// constì˜ ê²½ìš°
console.log('--- const í˜¸ì´ìŠ¤íŒ… ---');
// console.log(constVariable); // âŒ ReferenceError
const constVariable = 'const ë³€ìˆ˜';
console.log(constVariable); // const ë³€ìˆ˜

console.log('='.repeat(40));

// ==========================================
// 6. í•¨ìˆ˜ í˜¸ì´ìŠ¤íŒ…
// ==========================================

// âœ… í•¨ìˆ˜ ì„ ì–¸ë¬¸ - ì „ì²´ê°€ í˜¸ì´ìŠ¤íŒ…ë¨
sayHello(); // âœ… ì •ìƒ ë™ì‘! "ì•ˆë…•í•˜ì„¸ìš”"

function sayHello() {
   console.log('ì•ˆë…•í•˜ì„¸ìš”');
}

sayHello(); // âœ… ì •ìƒ ë™ì‘! "ì•ˆë…•í•˜ì„¸ìš”"

// âŒ í•¨ìˆ˜ í‘œí˜„ì‹ (let/const) - ë³€ìˆ˜ í˜¸ì´ìŠ¤íŒ… ê·œì¹™ ì ìš©
// sayGoodbye(); // âŒ ReferenceError

const sayGoodbye = function () {
   console.log('ì•ˆë…•íˆê°€ì„¸ìš”');
};

sayGoodbye(); // âœ… ì •ìƒ ë™ì‘!

// âŒ í™”ì‚´í‘œ í•¨ìˆ˜ - í•¨ìˆ˜ í‘œí˜„ì‹ê³¼ ë™ì¼
// greet(); // âŒ ReferenceError

const greet = () => {
   console.log('ì¸ì‚¬');
};

greet(); // âœ… ì •ìƒ ë™ì‘!

console.log('='.repeat(40));

// ==========================================
// 7. ìŠ¤ì½”í”„ì™€ í˜¸ì´ìŠ¤íŒ…
// ==========================================

// varëŠ” í•¨ìˆ˜ ìŠ¤ì½”í”„
function testVar() {
   console.log(x); // undefined
   if (true) {
      var x = 10;
   }
   console.log(x); // 10 (í•¨ìˆ˜ ìŠ¤ì½”í”„ë¼ if ë°–ì—ì„œë„ ì ‘ê·¼ ê°€ëŠ¥)
}
testVar();

// let/constëŠ” ë¸”ë¡ ìŠ¤ì½”í”„
function testLet() {
   // console.log(y); // âŒ ReferenceError
   if (true) {
      let y = 10;
      console.log(y); // 10
   }
   // console.log(y); // âŒ ReferenceError (ë¸”ë¡ ë°–ì—ì„œ ì ‘ê·¼ ë¶ˆê°€)
}
testLet();

console.log('='.repeat(40));

// ==========================================
// 8. ì‹¤ì „ ì˜ˆì œ - ë©´ì ‘ ë‹¨ê³¨ ì§ˆë¬¸
// ==========================================

// ì˜ˆì œ 1: ì´ ì½”ë“œì˜ ì¶œë ¥ì€?
console.log('--- ì˜ˆì œ 1 ---');
console.log(a); // undefined
var a = 1;
console.log(a); // 1

// ì˜ˆì œ 2: ì´ ì½”ë“œì˜ ì¶œë ¥ì€?
console.log('--- ì˜ˆì œ 2 ---');
// console.log(b); // ReferenceError
// let b = 2;

// ì˜ˆì œ 3: ì´ ì½”ë“œì˜ ì¶œë ¥ì€?
console.log('--- ì˜ˆì œ 3 ---');
foo(); // "foo í•¨ìˆ˜"

function foo() {
   console.log('foo í•¨ìˆ˜');
}

// ì˜ˆì œ 4: ì´ ì½”ë“œì˜ ì¶œë ¥ì€?
console.log('--- ì˜ˆì œ 4 ---');
// bar(); // TypeError: bar is not a function
var bar = function () {
   console.log('bar í•¨ìˆ˜');
};
bar(); // "bar í•¨ìˆ˜"

console.log('='.repeat(40));

// ==========================================
// 9. ì™œ let/constë„ í˜¸ì´ìŠ¤íŒ…ë ê¹Œ?
// ==========================================
/**
 * [ì¦ëª… ì˜ˆì œ]
 * ë§Œì•½ letì´ í˜¸ì´ìŠ¤íŒ…ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´,
 * ì•„ë˜ ì½”ë“œì—ì„œ ì™¸ë¶€ nameì„ ì°¸ì¡°í•´ì•¼ í•¨
 *
 * í•˜ì§€ë§Œ ReferenceErrorê°€ ë°œìƒí•¨
 * = letì´ í˜¸ì´ìŠ¤íŒ…ë˜ì–´ ë‚´ë¶€ ìŠ¤ì½”í”„ì— ì¡´ì¬í•˜ì§€ë§Œ
 *   TDZì— ê±¸ë ¤ìˆë‹¤ëŠ” ì¦ê±°!
 */

let scopedName = 'ì™¸ë¶€ ë³€ìˆ˜';

function test() {
   // console.log(scopedName); // âŒ ReferenceError
   // ë§Œì•½ í˜¸ì´ìŠ¤íŒ…ì´ ì•ˆ ëë‹¤ë©´ 'ì™¸ë¶€ ë³€ìˆ˜'ê°€ ì¶œë ¥ë˜ì–´ì•¼ í•¨
   // í•˜ì§€ë§Œ ì—ëŸ¬ ë°œìƒ = í˜¸ì´ìŠ¤íŒ…ëœ ë‚´ë¶€ scopedNameì´ TDZì— ìˆìŒ

   let scopedName = 'ë‚´ë¶€ ë³€ìˆ˜';
   console.log(scopedName); // ë‚´ë¶€ ë³€ìˆ˜
}

test();
console.log(scopedName); // ì™¸ë¶€ ë³€ìˆ˜

console.log('='.repeat(40));

// ==========================================
// 10. í•µì‹¬ ì •ë¦¬
// ==========================================
/**
 * âœ… varì˜ í˜¸ì´ìŠ¤íŒ…:
 * - ì„ ì–¸ + undefined ì´ˆê¸°í™”
 * - ì„ ì–¸ ì „ ì ‘ê·¼ ê°€ëŠ¥ (undefined ë°˜í™˜)
 * - ë²„ê·¸ ìœ ë°œ ê°€ëŠ¥ì„± ë†’ìŒ
 *
 * âœ… let/constì˜ í˜¸ì´ìŠ¤íŒ…:
 * - ì„ ì–¸ë§Œ í˜¸ì´ìŠ¤íŒ… (ì´ˆê¸°í™” X)
 * - TDZì— ë¹ ì§
 * - ì„ ì–¸ ì „ ì ‘ê·¼ ì‹œ ReferenceError
 * - ë” ì•ˆì „í•œ ì½”ë“œ ì‘ì„± ê°€ëŠ¥
 *
 * âœ… í•¨ìˆ˜ ì„ ì–¸ë¬¸:
 * - ì „ì²´ê°€ í˜¸ì´ìŠ¤íŒ…
 * - ì„ ì–¸ ì „ í˜¸ì¶œ ê°€ëŠ¥
 *
 * âœ… í•¨ìˆ˜ í‘œí˜„ì‹/í™”ì‚´í‘œ í•¨ìˆ˜:
 * - ë³€ìˆ˜ í˜¸ì´ìŠ¤íŒ… ê·œì¹™ ì ìš©
 * - let/const ì‚¬ìš© ì‹œ TDZ ì ìš©
 *
 * ğŸ”¥ ë©´ì ‘ í¬ì¸íŠ¸:
 * "let/constë„ í˜¸ì´ìŠ¤íŒ…ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ TDZ(Temporal Dead Zone) ë•Œë¬¸ì—
 *  ì´ˆê¸°í™” ì „ì— ì ‘ê·¼í•˜ë©´ ReferenceErrorê°€ ë°œìƒí•©ë‹ˆë‹¤."
 */

// ==========================================
// 11. ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤
// ==========================================
/**
 * âœ… ê¶Œì¥ì‚¬í•­:
 * 1. var ì‚¬ìš© ê¸ˆì§€
 * 2. ë³€ìˆ˜ëŠ” ì‚¬ìš© ì „ì— ì„ ì–¸
 * 3. ë³€ìˆ˜ ì„ ì–¸ì€ ìŠ¤ì½”í”„ ìµœìƒë‹¨ì—
 * 4. constë¥¼ ê¸°ë³¸ìœ¼ë¡œ, í•„ìš”ì‹œ let ì‚¬ìš©
 * 5. í•¨ìˆ˜ ì„ ì–¸ë¬¸ë³´ë‹¤ í•¨ìˆ˜ í‘œí˜„ì‹ ê¶Œì¥ (ëª…í™•ì„±)
 */

// âœ… ì¢‹ì€ ì˜ˆ
const userName = 'ì•ˆìœ ì§„';
const userAge = 21;

function processUser() {
   console.log(userName, userAge);
}

processUser();

console.log('='.repeat(40));

// ==========================================
// 12. ì¶”ê°€ ì‹¬í™” í¬ì¸íŠ¸ (ë©´ì ‘ì—ì„œ ì ìˆ˜ ì˜¬ë¼ê°€ëŠ” íŒŒíŠ¸)
// ==========================================
/**
 * âœ… ì—¬ê¸°ë¶€í„°ëŠ” â€œí˜¸ì´ìŠ¤íŒ…â€ì„ í•œ ë‹¨ê³„ ë” ì •í™•íˆ ì„¤ëª…í•  ë•Œ ì“°ëŠ” ì¬ë£Œë“¤
 * - classë„ TDZê°€ ìˆë‹¤
 * - default parameterë„ TDZê°€ ìˆë‹¤
 * - ë¸”ë¡ ì•ˆ í•¨ìˆ˜ ì„ ì–¸ì€(íŠ¹íˆ strict) ìŠ¤ì½”í”„ê°€ ë‹¤ë¥´ê²Œ ë™ì‘í•  ìˆ˜ ìˆë‹¤
 * - for + ë¹„ë™ê¸°ì—ì„œ var/let ì°¨ì´ê°€ í­ë°œí•œë‹¤
 */

function printError(label, fn) {
   try {
      fn();
   } catch (e) {
      console.log(`${label}:`, e.name, '-', e.message);
   }
}

// 12-1) class ì„ ì–¸ë„ â€œëŒì–´ì˜¬ë ¤ì§„ ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œâ€ TDZ ë•Œë¬¸ì— ë¨¼ì € ì“°ë©´ í„°ì§
console.log('--- class TDZ ---');
printError('class ì„ ì–¸ ì „ ì‚¬ìš©', () => {
   new IdolClass();
});

class IdolClass {
   constructor() {
      this.name = 'ì•„ì´ë¸Œ';
   }
}

console.log('class ì„ ì–¸ í›„ ì‚¬ìš©:', new IdolClass().name);

console.log('='.repeat(40));

// 12-2) default parameter TDZ (ë©´ì ‘ ë‹¨ê³¨)
console.log('--- default parameter TDZ ---');
printError('f(x = y, y = 1)', () => {
   (function f(x = y, y = 1) {
      return [x, y];
   })();
});

console.log(
   'ì •ìƒ ì¼€ì´ìŠ¤:',
   (function ok(x = 1, y = 2) {
      return [x, y];
   })(),
);

console.log('='.repeat(40));

// 12-3) ë¸”ë¡ ìŠ¤ì½”í”„ + í•¨ìˆ˜ ì„ ì–¸ (strict ëª¨ë“œì—ì„œ íŠ¹íˆ ì¡°ì‹¬)
console.log('--- block function (strict) ---');
(function () {
   'use strict';

   if (true) {
      function insideBlock() {
         return 'ë¸”ë¡ ì•ˆ í•¨ìˆ˜';
      }
      console.log('ë¸”ë¡ ì•ˆ í˜¸ì¶œ:', insideBlock());
   }

   // strict í™˜ê²½ì—ì„œëŠ” ë¸”ë¡ ë°–ì—ì„œ ì ‘ê·¼ì´ ì•ˆ ë˜ëŠ” ì¼€ì´ìŠ¤ê°€ ë§ìŒ
   printError('ë¸”ë¡ ë°– í˜¸ì¶œ', () => {
      insideBlock();
   });
})();

console.log('='.repeat(40));

// 12-4) for + ë¹„ë™ê¸°(setTimeout)ì—ì„œ var vs let ì°¨ì´
console.log('--- for-loop closure (ë¹„ë™ê¸°) ---');
for (var i = 0; i < 3; i++) {
   setTimeout(() => console.log('var i:', i), 0); // 3,3,3
}

for (let j = 0; j < 3; j++) {
   setTimeout(() => console.log('let j:', j), 0); // 0,1,2
}

console.log('='.repeat(40));

// 12-5) (ì„¤ëª…ë§Œ) ëª¨ë“ˆ(import/export) í™˜ê²½ì—ì„œëŠ” TDZê°€ ë” ìì£¼ ë“œëŸ¬ë‚¨
/**
 * ğŸ“Œ ëª¨ë“ˆì—ì„œ ìì£¼ ë³´ëŠ” ì—ëŸ¬
 * - importë¡œ ê°€ì ¸ì˜¨ ë°”ì¸ë”©ë„ â€œì´ˆê¸°í™” ì „ ì ‘ê·¼â€ì€ ë¶ˆê°€
 * - ìˆœí™˜ ì°¸ì¡°(circular dependency) ìƒí™©ì—ì„œ TDZê°€ í‘œë©´ìœ¼ë¡œ íŠ€ì–´ë‚˜ì˜´
 *
 * ì¦‰, "ì„ ì–¸ì€ ì¡í˜”ëŠ”ë°(ì¡´ì¬ëŠ” í•˜ëŠ”ë°) ì•„ì§ ê°’ì´ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ë‹¤"ê°€ TDZì˜ ë³¸ì§ˆ.
 */

// ==========================================
// 13. ì‹¤ë¬´ íŒ¨í„´ (í˜¸ì´ìŠ¤íŒ… ì‚¬ê³  ì¤„ì´ëŠ” ìŠµê´€)
// ==========================================
/**
 * âœ… ì‹¤ë¬´ íŒ
 * 1) íŒŒì¼ ìƒë‹¨ì— "ì„ ì–¸ êµ¬ì—­"ì„ ë§Œë“¤ê³ , ì•„ë˜ì— "ì‹¤í–‰ êµ¬ì—­"ì„ ë‘”ë‹¤
 * 2) í•¨ìˆ˜ëŠ” const í•¨ìˆ˜ í‘œí˜„ì‹/í™”ì‚´í‘œë¡œ í†µì¼í•˜ë©´ í˜¸ì¶œ íƒ€ì´ë°ì´ ì„ ëª…í•´ì§„ë‹¤
 * 3) ê°™ì€ ìŠ¤ì½”í”„ì—ì„œ var/let/const ì„ì–´ì„œ ê°™ì€ ì´ë¦„ ì“°ì§€ ë§ê¸° (ì´ë²ˆ íŒŒì¼ë„ ê·¸ ì¼€ì´ìŠ¤ê°€ ìˆì—ˆìŒ)
 */

// ì„ ì–¸ êµ¬ì—­
const add = (a, b) => a + b;

function run() {
   console.log('add(2, 3) =', add(2, 3));
}

// ì‹¤í–‰ êµ¬ì—­
run();

// âŒ ë‚˜ìœ ì˜ˆ
// processUser2(); // ì„ ì–¸ ì „ í˜¸ì¶œ
// var userName2 = 'ì¥ì›ì˜'; // var ì‚¬ìš©

console.log('='.repeat(40));
console.log('í˜¸ì´ìŠ¤íŒ… ì™„ë²½ ì •ë¦¬ ë!');
