/**
 * 0N_ex í´ë”ëª… ì¶”ì²œ: 08_function_hoisting_scope
 * ------------------------------------------------------------
 * ğŸ“Œ ì£¼ì œ: í•¨ìˆ˜(Function) / í˜¸ì´ìŠ¤íŒ…(Hoisting) / ìŠ¤ì½”í”„(Scope) / ì¤‘ì²©í•¨ìˆ˜(Nested Function)
 * ------------------------------------------------------------
 * âœ… ì´ íŒŒì¼ì€ Nodeë¡œ ë°”ë¡œ ì‹¤í–‰ ê°€ëŠ¥: `node app.js`
 */

console.clear?.();
console.log('08_í•¨ìˆ˜ (Function / Hoisting / Scope)');
console.log('='.repeat(60));

// ============================================================
// 1) ğŸ“Œ í•µì‹¬ ê°œë… + í‚¤ë…¸íŠ¸ + ì–¸ì œ ì“°ëŠ”ì§€
// ============================================================
{
   /**
    * ğŸ”¥ í‚¤ë…¸íŠ¸(ìš”ì•½ 6ì¤„)
    * 1) í•¨ìˆ˜ ì„ ì–¸ë¬¸(function foo(){})ì€ "í˜¸ì´ìŠ¤íŒ…"ë˜ì–´ ì„ ì–¸ ì „ì— í˜¸ì¶œ ê°€ëŠ¥.
    * 2) í•¨ìˆ˜ í‘œí˜„ì‹(const foo = () => {})ì€ ë³€ìˆ˜ì— ë‹´ê¸°ë¯€ë¡œ TDZ/ì´ˆê¸°í™” ì´ì „ í˜¸ì¶œ ë¶ˆê°€.
    * 3) í•¨ìˆ˜ëŠ” "ì…ë ¥(ë§¤ê°œë³€ìˆ˜) -> ì²˜ë¦¬ -> ì¶œë ¥(ë°˜í™˜)" íë¦„ì„ ìº¡ìŠí™”í•œë‹¤. â­
    * 4) ì¤‘ì²© í•¨ìˆ˜ëŠ” ë°”ê¹¥ í•¨ìˆ˜ì˜ ë³€ìˆ˜ë¥¼ ì°¸ì¡°(í´ë¡œì €)í•  ìˆ˜ ìˆì–´ "ì€ë‹‰/í—¬í¼"ì— ìì£¼ ì“´ë‹¤. â­
    * 5) ìŠ¤ì½”í”„ëŠ” ë³€ìˆ˜ ì ‘ê·¼ ê°€ëŠ¥í•œ ë²”ìœ„ë¥¼ ê²°ì •í•˜ë©°, ë¸”ë¡ ìŠ¤ì½”í”„(let/const)ê°€ ê¸°ë³¸ì´ë‹¤. ğŸ”¥
    * 6) ì‹¤ë¬´ì—ì„œëŠ” "ìˆœìˆ˜ í•¨ìˆ˜" + "ëª…í™•í•œ ë„¤ì´ë°" + "ì—ëŸ¬ ë°©ì–´"ê°€ í’ˆì§ˆì„ ì¢Œìš°í•œë‹¤. â­
    *
    * ì–¸ì œ ì“°ë‚˜?
    * - ê³„ì‚°/ë³€í™˜ ë¡œì§ ë¶„ë¦¬(ê°€ê²© ê³„ì‚°, í¬ë§·íŒ…, ê²€ì¦)
    * - UI ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ state ì—…ë°ì´íŠ¸ ë¡œì§ ë¶„ë¦¬
    * - API ì‘ë‹µ ì •ê·œí™”/ê°€ê³µ, ê³µí†µ ìœ í‹¸ í•¨ìˆ˜
    */
}

// ============================================================
// 2) ğŸŒ± ì´ˆê¸‰ â†’ ğŸš€ ì¤‘ê¸‰ â†’ âš¡ ê³ ê¸‰ â†’ ğŸ’¼ ì‹¤ë¬´ íŒ¨í„´
//    ê° ë‹¨ê³„: ì„¤ëª… â†’ ì§ê´€ì  ì½”ë“œ â†’ ì‹¤í–‰ ê²°ê³¼
// ============================================================

// ------------------------------------------------------------
// ğŸŒ± ì´ˆê¸‰: "í•¨ìˆ˜ ì„ ì–¸" + ë°˜í™˜ê°’(return) + ì¤‘ì²©í•¨ìˆ˜ ë§›ë³´ê¸°
// ------------------------------------------------------------
{
   console.log('\nğŸŒ± [ì´ˆê¸‰] í•¨ìˆ˜ ì„ ì–¸ + return + ì¤‘ì²©í•¨ìˆ˜');

   // âœ… ì¢‹ì€ ì˜ˆ: í•¨ìˆ˜ëª…ì€ ë™ì‚¬+ëª©ì ì–´(ì˜ë„)ë¡œ
   function calculateArea(width, height) {
      // ğŸ’¡ ê¿€íŒ: ë‚´ë¶€ì—ì„œë§Œ ì“°ëŠ” í—¬í¼ëŠ” ì¤‘ì²©í•¨ìˆ˜ë¡œ ìˆ¨ê²¨ë„ OK
      function logDebug() {
         console.log('[debug] calculateArea called'); // ì‹¤í–‰ íë¦„ í™•ì¸
      }

      logDebug(); // ì¤‘ì²© í•¨ìˆ˜ í˜¸ì¶œ

      const area = width * height; // let ëŒ€ì‹  const: ê°’ ì¬í• ë‹¹ì´ ì—†ìœ¼ë©´ constê°€ ê¸°ë³¸ â­
      return area; // ê³„ì‚° ê²°ê³¼ë¥¼ ë°˜í™˜
   }

   const area1 = calculateArea(20, 20);
   console.log('âœ… ì‹¤í–‰ ê²°ê³¼:', area1); // 400
}

// ------------------------------------------------------------
// ğŸš€ ì¤‘ê¸‰: í˜¸ì´ìŠ¤íŒ… ë¹„êµ(ì„ ì–¸ë¬¸ vs í‘œí˜„ì‹) + TDZ ë§›ë³´ê¸°
// ------------------------------------------------------------
{
   console.log('\nğŸš€ [ì¤‘ê¸‰] í˜¸ì´ìŠ¤íŒ…: ì„ ì–¸ë¬¸ vs í‘œí˜„ì‹(í™”ì‚´í‘œ)');

   // âœ… ì¢‹ì€ ì˜ˆ: ì„ ì–¸ë¬¸ì€ í˜¸ì¶œì´ ì„ ì–¸ë³´ë‹¤ ìœ„ì—¬ë„ ë™ì‘(í˜¸ì´ìŠ¤íŒ…)
   const sumFromDeclaration = addDeclaration(2, 3);
   console.log('âœ… addDeclaration(2,3) =', sumFromDeclaration);

   function addDeclaration(a, b) {
      return a + b;
   }

   // âš ï¸ ì£¼ì˜: í•¨ìˆ˜ í‘œí˜„ì‹ì€ "ë³€ìˆ˜"ì— ë‹´ê¸°ëŠ” ìˆœê°„ë¶€í„° ê·œì¹™ì´ ë‹¬ë¼ì§
   // - ì•„ë˜ëŠ” "ì˜ë„ì ìœ¼ë¡œ" try/catchë¡œ ë³´ì—¬ì£¼ëŠ” ì˜ˆì‹œ
   try {
      // âŒ ë‚˜ìœ ì˜ˆ: ì´ˆê¸°í™” ì „ì— í˜¸ì¶œí•˜ë©´ ëŸ°íƒ€ì„ ì—ëŸ¬ ê°€ëŠ¥
      // (const/letì€ TDZ ë•Œë¬¸ì— ì„ ì–¸ ì „ì— ì ‘ê·¼ ìì²´ê°€ ë§‰í˜)
      const result = addExpression(2, 3);
      console.log('âŒ (ì—¬ê¸°ê¹Œì§€ ì˜¤ë©´ ì•ˆ ë¨)', result);
   } catch (error) {
      console.log(
         'âš ï¸ ì‹¤í–‰ ê²°ê³¼: í‘œí˜„ì‹ì€ ì„ ì–¸(ì´ˆê¸°í™”) ì „ í˜¸ì¶œ ë¶ˆê°€ ->',
         error.message,
      );
   }

   // âœ… ì¢‹ì€ ì˜ˆ: í‘œí˜„ì‹ì€ "ì •ì˜ ì´í›„"ì— ì‚¬ìš©
   const addExpression = (a, b) => a + b; // í™”ì‚´í‘œ í•¨ìˆ˜ í‘œí˜„ì‹
   console.log('âœ… addExpression(2,3) =', addExpression(2, 3));
}

// ------------------------------------------------------------
// âš¡ ê³ ê¸‰: ìŠ¤ì½”í”„(ë¸”ë¡/í•¨ìˆ˜) + í´ë¡œì €ë¡œ ìƒíƒœ ìº¡ìŠí™”
// ------------------------------------------------------------
{
   console.log('\nâš¡ [ê³ ê¸‰] ìŠ¤ì½”í”„ + í´ë¡œì €ë¡œ ìƒíƒœ ìˆ¨ê¸°ê¸°(ìº¡ìŠí™”)');

   // ğŸ”¥ í•µì‹¬: í•¨ìˆ˜ëŠ” ìì‹ ì´ ì„ ì–¸ëœ ìŠ¤ì½”í”„ì˜ ë³€ìˆ˜ë¥¼ "ê¸°ì–µ"í•  ìˆ˜ ìˆë‹¤(í´ë¡œì €)
   function createCounter(label) {
      let count = 0; // private state (ì™¸ë¶€ì—ì„œ ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€)

      const get = () => count;
      const inc = () => (count += 1);
      const reset = () => (count = 0);

      console.log(`[${label}] counter created`);
      return { get, inc, reset };
   }

   const counterA = createCounter('A');
   console.log('A get ->', counterA.get()); // 0
   console.log('A inc ->', counterA.inc()); // 1
   console.log('A inc ->', counterA.inc()); // 2
   counterA.reset();
   console.log('A reset ->', counterA.get()); // 0

   const counterB = createCounter('B');
   console.log('B inc ->', counterB.inc()); // 1 (Aì™€ ë…ë¦½)
}

// ------------------------------------------------------------
// ğŸ’¼ ì‹¤ë¬´ íŒ¨í„´: ì…ë ¥ ê²€ì¦ + ìˆœìˆ˜ í•¨ìˆ˜ + ë¡œê¹…/ë””ë²„ê¹… íŒ
//   - ì‹¤ì œ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ 2~3ê°œ
//   - íŒ€ í˜‘ì—… ì‹œ ê³ ë ¤ì‚¬í•­
//   - ë””ë²„ê¹… íŒ
// ------------------------------------------------------------
{
   console.log('\nğŸ’¼ [ì‹¤ë¬´ íŒ¨í„´] ì…ë ¥ ê²€ì¦ + ìˆœìˆ˜ í•¨ìˆ˜ + í˜‘ì—… í¬ì¸íŠ¸');

   // â­ ì‹¤ë¬´ í•„ìˆ˜: "ê²½ê³„"(ì…ë ¥/ì™¸ë¶€ ë°ì´í„°)ì—ì„œ ê²€ì¦í•˜ê¸°
   const isFiniteNumber = (value) =>
      typeof value === 'number' && Number.isFinite(value);

   // âœ… ì¢‹ì€ ì˜ˆ: ìˆœìˆ˜ í•¨ìˆ˜(pure)
   // - ê°™ì€ ì…ë ¥ -> ê°™ì€ ì¶œë ¥
   // - ì™¸ë¶€ ìƒíƒœ/DOM/ì‹œê°„ì— ì˜ì¡´ X
   function calculateRectangleAreaSafe(width, height) {
      if (!isFiniteNumber(width) || !isFiniteNumber(height)) {
         throw new TypeError('width/heightëŠ” ìœ í•œí•œ numberì—¬ì•¼ í•©ë‹ˆë‹¤.');
      }

      if (width < 0 || height < 0) {
         throw new RangeError('width/heightëŠ” 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
      }

      return width * height;
   }

   // ì‹œë‚˜ë¦¬ì˜¤ 1) ê°€ê²©/ë©´ì /ìˆ˜ëŸ‰ ê³„ì‚°
   try {
      const area = calculateRectangleAreaSafe(10, 12);
      console.log('âœ… ì‹œë‚˜ë¦¬ì˜¤1(ê³„ì‚°):', area);
   } catch (error) {
      console.log('âš ï¸ ì‹œë‚˜ë¦¬ì˜¤1 ì—ëŸ¬:', error.message);
   }

   // ì‹œë‚˜ë¦¬ì˜¤ 2) API ì‘ë‹µ ê°€ê³µ(ì™¸ë¶€ ë°ì´í„°ëŠ” ì‹ ë¢° X)
   const apiPayload = {
      width: '10', // âŒ ë¬¸ìì—´ë¡œ ì˜´ (ì‹¤ë¬´ì—ì„œ í”í•¨)
      height: 3,
   };

   const toNumber = (value) =>
      typeof value === 'string' ? Number(value) : value;

   try {
      const normalizedWidth = toNumber(apiPayload.width);
      const normalizedHeight = toNumber(apiPayload.height);

      const area = calculateRectangleAreaSafe(
         normalizedWidth,
         normalizedHeight,
      );
      console.log('âœ… ì‹œë‚˜ë¦¬ì˜¤2(API ì •ê·œí™”):', area);
   } catch (error) {
      console.log('âš ï¸ ì‹œë‚˜ë¦¬ì˜¤2 ì—ëŸ¬:', error.message);
   }

   // ì‹œë‚˜ë¦¬ì˜¤ 3) UI ì´ë²¤íŠ¸ì—ì„œ ê³„ì‚° ë¡œì§ ë¶„ë¦¬(React/DOMì—ì„œë„ ë™ì¼)
   function onResizeLikeEvent(nextWidth, nextHeight) {
      // ğŸ”¥ í˜‘ì—… í¬ì¸íŠ¸: ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ëŠ” "ì¡°ë¦½"ë§Œ í•˜ê³  ë¡œì§ì€ ë°–ìœ¼ë¡œ ë¹¼ê¸°
      try {
         const area = calculateRectangleAreaSafe(nextWidth, nextHeight);
         console.log('âœ… ì‹œë‚˜ë¦¬ì˜¤3(UI ì´ë²¤íŠ¸): area =', area);
      } catch (error) {
         console.log('âš ï¸ ì‹œë‚˜ë¦¬ì˜¤3(UI ì´ë²¤íŠ¸) ì—ëŸ¬:', error.message);
      }
   }

   onResizeLikeEvent(5, 7);

   // ğŸ’¡ ë””ë²„ê¹… íŒ
   // - console.logë¥¼ "ë¼ë²¨"ê³¼ í•¨ê»˜ ì°ê¸°: ê°’ì˜ ì˜ë¯¸ê°€ ì‚´ì•„ë‚¨ìŒ
   // - í•¨ìˆ˜ ì‹œì‘/ë ì§€ì ì— ë¡œê·¸ë¥¼ ë‚¨ê²¨ íë¦„ì„ ì¶”ì 
   // - try/catchë¡œ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì‚¬ìš©ì/ê°œë°œìì—ê²Œ ë¶„ë¦¬ ì¶œë ¥
}

// ============================================================
// 3) ğŸ›¡ï¸ ë°©ì–´ì  ì½”ë”© (í•¨ì •Â·ì—ëŸ¬Â·í•´ê²°ë²•)
// ============================================================
{
   console.log('\nğŸ›¡ï¸ [ë°©ì–´ì  ì½”ë”©] í”í•œ í•¨ì • ëª¨ìŒ');

   // 1) âŒ ì˜¤íƒ€/ë„¤ì´ë° í•¨ì •: areal ê°™ì€ ë³€ìˆ˜ëª…
   // âœ… í•´ê²°: areaì²˜ëŸ¼ ì˜ë¯¸ê°€ ëª…í™•í•œ ì´ë¦„ + lint/formatter ì‚¬ìš©
   const area = 20 * 20;
   console.log('âœ… ë„¤ì´ë°: area =', area);

   // 2) âš ï¸ í•¨ìˆ˜ í‘œí˜„ì‹ í˜¸ì´ìŠ¤íŒ… ì°©ê°
   // âœ… í•´ê²°: í‘œí˜„ì‹ì€ "ì •ì˜ ì´í›„" ì‚¬ìš©, ë˜ëŠ” ì„ ì–¸ë¬¸ ì‚¬ìš©

   // 3) âš ï¸ ì¤‘ì²© í•¨ìˆ˜ ë‚¨ë°œ
   // - ë„ˆë¬´ ê¹Šì–´ì§€ë©´ ê°€ë…ì„±â†“ / í…ŒìŠ¤íŠ¸ ì–´ë ¤ì›€
   // âœ… í•´ê²°: ì¤‘ì²©ì€ "ì§„ì§œ ë‚´ë¶€ ì „ìš©" í—¬í¼ë§Œ, ì•„ë‹ˆë©´ ë°–ìœ¼ë¡œ ë¹¼ê¸°

   // 4) âš ï¸ ì…ë ¥ ê²€ì¦ ì—†ì´ ê³„ì‚°
   // âœ… í•´ê²°: ì‹¤ë¬´ ê²½ê³„ì—ì„œ íƒ€ì…/ë²”ìœ„ ê²€ì‚¬(ìœ„ ì‹¤ë¬´íŒ¨í„´ ì°¸ê³ )

   // 5) ğŸ’¡ ë””ë²„ê¹…: ê°’ë§Œ ì°ì§€ ë§ê³  "ì˜ë¯¸"ë¥¼ ì°ê¸°
   const width = 3;
   const height = 4;
   console.log({ width, height, computedArea: width * height });
}

// ============================================================
// 4) ğŸ“ í•µì‹¬ ì •ë¦¬ (10~12ê°œ)
// ============================================================
{
   console.log('\nğŸ“ [í•µì‹¬ ì •ë¦¬]');

   const summary = [
      '1) í•¨ìˆ˜ëŠ” ì…ë ¥â†’ì²˜ë¦¬â†’ì¶œë ¥ì„ ìº¡ìŠí™”í•œë‹¤. â­',
      '2) returnì´ ì—†ìœ¼ë©´ ê¸°ë³¸ ë°˜í™˜ì€ undefined.',
      '3) í•¨ìˆ˜ ì„ ì–¸ë¬¸ì€ í˜¸ì´ìŠ¤íŒ…ë˜ì–´ ì„ ì–¸ ì „ì— í˜¸ì¶œ ê°€ëŠ¥. ğŸ”¥',
      '4) í•¨ìˆ˜ í‘œí˜„ì‹/í™”ì‚´í‘œëŠ” ë³€ìˆ˜ ì´ˆê¸°í™” ì „ í˜¸ì¶œ ë¶ˆê°€(TDZ). âš ï¸',
      '5) let/constëŠ” ë¸”ë¡ ìŠ¤ì½”í”„, varëŠ” í•¨ìˆ˜ ìŠ¤ì½”í”„(ê¶Œì¥ X). âš ï¸',
      '6) ì¤‘ì²© í•¨ìˆ˜ëŠ” ë°”ê¹¥ ë³€ìˆ˜ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤(í´ë¡œì €). â­',
      '7) í´ë¡œì €ëŠ” ìƒíƒœ ì€ë‹‰/ì¹´ìš´í„°/ìºì‹œ/ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì— ìì£¼ ì‚¬ìš©. â­',
      '8) ì‹¤ë¬´ì—ì„œëŠ” ê²½ê³„(ì…ë ¥/API)ì—ì„œ ê²€ì¦ì´ ì¤‘ìš”í•˜ë‹¤. â­',
      '9) ìˆœìˆ˜ í•¨ìˆ˜ëŠ” í…ŒìŠ¤íŠ¸/ë¦¬íŒ©í„°ë§ì´ ì‰½ë‹¤. ğŸ”¥',
      '10) ì—ëŸ¬ëŠ” throwí•˜ê³  í˜¸ì¶œìê°€ ì²˜ë¦¬(try/catch)í•˜ë„ë¡ ì±…ì„ ë¶„ë¦¬. â­',
      '11) console.logëŠ” ë¼ë²¨/ê°ì²´ í˜•íƒœë¡œ ì°ìœ¼ë©´ ë””ë²„ê¹…ì´ ì‰¬ì›Œì§„ë‹¤. ğŸ’¡',
      '12) ë„¤ì´ë°(ë™ì‚¬+ëª©ì ì–´)ê³¼ ì¼ê´€ëœ ì»¨ë²¤ì…˜ì´ ìœ ì§€ë³´ìˆ˜ ë¹„ìš©ì„ ì¤„ì¸ë‹¤. â­',
   ];

   summary.forEach((line) => console.log(line));
}

// ============================================================
// 5) ğŸ”— ì‹¤ì „ ì ìš© (í”„ë¡œì íŠ¸ ì˜ˆì‹œ)
// ============================================================
{
   console.log('\nğŸ”— [ì‹¤ì „ ì ìš© ì˜ˆì‹œ]');

   /**
    * ì˜ˆì‹œ A) ì‡¼í•‘ëª°: ë°°ì†¡ë¹„ ê³„ì‚°
    * - ì…ë ¥: ìƒí’ˆ ê°€ê²©, ì§€ì—­, ì¿ í° ì—¬ë¶€
    * - ì¶œë ¥: ìµœì¢… ë°°ì†¡ë¹„
    * - í¬ì¸íŠ¸: "ê²½ê³„ ê²€ì¦" + "ìˆœìˆ˜ í•¨ìˆ˜" + "ìƒíƒœ(ì •ì±…) ë¶„ë¦¬"
    */

   function calculateShippingFee(price, region) {
      // ì…ë ¥ ê²€ì¦
      if (typeof price !== 'number' || !Number.isFinite(price)) return 0;
      if (region !== 'seoul' && region !== 'local' && region !== 'island')
         return 0;

      // ì •ì±…(ë£°) ë¶„ë¦¬
      if (price >= 50000) return 0;
      if (region === 'island') return 6000;
      if (region === 'seoul') return 2500;
      return 3500;
   }

   console.log('ë°°ì†¡ë¹„(seoul, 30000) =', calculateShippingFee(30000, 'seoul'));
   console.log(
      'ë°°ì†¡ë¹„(island, 30000) =',
      calculateShippingFee(30000, 'island'),
   );
   console.log('ë°°ì†¡ë¹„(local, 60000) =', calculateShippingFee(60000, 'local'));

   /**
    * ì˜ˆì‹œ B) UI: ìˆ«ì ì…ë ¥ ê²€ì¦ í›„ ë©´ì  ê³„ì‚°
    * - Reactë¼ë©´ onChangeì—ì„œ setState í•˜ê³ ,
    * - ê³„ì‚° í•¨ìˆ˜ëŠ” ë³„ë„ ìœ í‹¸ë¡œ ë¶„ë¦¬í•´ì„œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•˜ê²Œ.
    */
}

console.log('\nâœ… done');
